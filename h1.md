# Kybertappoketju

## Johdanto


## Tiivistys podcasteista, artikkeleista jne
Liirum laarum laa...

## K√§yt√§nn√∂n osuudet

### Oman koneen specsit
- Kone: Lenovo Yoga Slim 7i 14IMH9
- Prosessori: Intel Core 5 Ultra 125H
- Ram: LPDDR5X 16GB
- Tallennustila: 500GB NVME SSD
- OS: Windows 11 24H2

### Kali Linuxin asennus
VMBoxien asentaminen oli jo tuttua ennen kurssia, joten t√§m√§ onnistui helposti. Latasin Kali Linux Installer imagen heid√§n  [kotisivuiltaan](https://www.kali.org/get-kali/#kali-installer-images). T√§m√§n j√§lkeen asensin sen Oracle Virtualboxiin toimivaksi Virtual Machineksi. Versiona toimii uusin Kali Linux, eli 2025.2.
### Internet pois virtuaalikoneesta
Mieleen tuli kaksi tapaa ottaa netti pois virtuaalikoneesta, joko suoraan Virtualboxin asetuksista tai sitten itse VM:sta. Esimerkiksi suoraan Virtualboxista komennolla

    nmcli network off

Tai sitten laittaa Virtualiboxin asetuksista networkadapterin not attached. 
<img width="698" height="406" alt="image" src="https://github.com/user-attachments/assets/05f7a80b-295d-4d83-bde2-f41136fdccaf" />

Kuten kuvassa n√§kyy molemmat tavat toimivat. Itse p√§√§t√§n jatkaa komentorivi vaihtoehdolla, ihan vain nopeuden vuoksi. 
### Porttiskannaus

L√∂ysin eritt√§in hyv√§n cheat sheetin GitHubista Nmapin k√§ytt√∂√∂n [Linkki repoon](https://github.com/jasonniebauer/Nmap-Cheatsheet). Itse cheat sheetista ei l√∂ytynyt selityst√§ mit√§ agressiivinen skannaus tekee, muuta kuin ole agressiivinen üò†üí•. T√§h√§n l√∂ytyi hyv√§ dokumentti NMapin omilta sivuilta [Linkki sivulle](https://nmap.org/book/man-misc-options.html)

    nmap -T4 -A localhost

  - -T4 = Nopea skannaus. Parametrit ovat -T0 - -T4. Mit√§ pienempi numero sit√§ tarkempi skannaus
  - -A = Agressiivinen skannaus. Ottaa k√§ytt√∂√∂n seuraavat parametrit
      - -o = K√§ytt√∂j√§rjestelm√§n havainnointi
      - -sV = Version skannaus, kertoo mik√§ versio esimerkiksi Apachesta on
      - -sC = Skriptien skannaus.
      - --traceroute = N√§ytt√§√§ mink√§ reitin kautta paketit kulkee hostille

Seuraavaksi runaan annetun nmap komennon 
 
    nmap -T4 -A localhost
<img width="1329" height="527" alt="image" src="https://github.com/user-attachments/assets/cccd7e92-0ad1-4c76-a528-ec334652affa" />

### Mit√§ Nmapin vastaus kertoo kun yht√§√§n porttia ei ole auki
- Kertoo mihin kellonaikaan sek√§ p√§iv√§√§n komento suoritettiin
- Kertoo kohteen ip:n mihin scannaus suoritettiin, t√§ss√§ tapauksessa 127.0.0.1
- Host is up, kohde on saavutettavissa 
- Kaikki localhostin 1000 yleisint√§ porttia ovat kiinni.
- Liian monta mahdollista osumaa, joten k√§ytt√∂j√§rjestelm√§√§ ei voitu tunnistaa
- Koska skannaus tehtiin omaan koneeseen, on network distance 0 hops
- Scannauksen kesto 2.09 sekunttia

### Laiteaan p√§√§lle d(a)emonit :smiling_imp:
Seuraavaksi laitan p√§√§lle kaksi daemonia jotta p√§√§semme tutkimaan mit√§ komento tulostaa kun muutama portti on auki. :smiling_imp: 
  - SSH :smiling_imp:
  - apache2 :smiling_imp:

Komennot

        sudo systemctl enable --now apache2
        sudo systemctl enable --now ssh

<img width="895" height="784" alt="image" src="https://github.com/user-attachments/assets/cd971f5b-259b-4a76-940a-bf3ccfc0a783" />

### Mit√§ lis√§tietoa Nmapin vastaus antaa, jos useita portteja on auki?
- Kertoo ett√§ nyt oli 2 porttia auki
      - SSH auki portissa 22. Kertoo my√∂s SSH:n version
      - Apache auki portissa 80. Kertoo my√∂s Apachen version
- Nyt nmap pystyi tunnistamaan k√§ytt√∂j√§rjestelm√§n.
- Scannauksen kesto nousi 2,09 --> 8,79. T√§m√§ siksi, koska muutama portti oli auki, joten niiden skannaamiseen meni aikaa. Tietty pient√§ varianssia tulee varmasti, jos skannaa samalla tavalla monta kertaa, mutta ei n√§in suurta.

## Asennetaan Metasploitable 2 virtuaalikoneeseen
Asensin Metasploitable 2 zip tiedoston [t√§√§lt√§](https://sourceforge.net/projects/metasploitable/). Sen j√§lkeen purin tiedoston. T√§m√§n j√§lkeen loin normaalistin uuden virtuaalikoneen VMBoxissa. Pidin oletusasetukset, paitsi muutin  Hard Disk asetuksen. T√§st√§ laitoin asetuksen "Use existing Virtual Hard DIsk file jonka j√§lkeen laitoin puretun metasploitable.vmdk kyseiseksi tiedostoksi.
### Virtuaaliverkon tekeminen Kalin ja Metasploitablen v√§lille
Koneiden v√§lille saa tehty√§ helposti Host Only Networkin laittamalle sen p√§√§lle kyseisen virtuaalikoneen Settings --> Network --> Host Only adapter. Itse tein niin, ett√§ pidin Kalissa Adapter 1 alkuper√§isen adapterin asetukset, jotta saisin yhdistetty√§ internettiin mik√§li niin haluan. Adapter 2 laitoin Host only adapterin. Kun Adapter 1:ssa on kaapeli p√§√§ll√§, sain yhteyden internettiin, niin kuin pit√§isikin. Kun laitoin siit√§ kaapelin pois ja Adapter 2 (Host only) kaapelin p√§√§lle en saanut yhteytt√§ internettiin, eli kaikki toimii t√§ss√§ vaiheessa niin kuin pit√§√§kin. 
<img width="704" height="82" alt="image" src="https://github.com/user-attachments/assets/05d190c5-4711-4319-8abe-c1ab99787774" />

### Metasploitable p√§√§lle
Nyt laitetaan viell√§ Metasploitable p√§√§lle ja katsotaan onko se kalin kanssa samassa verkossa. 

Ensiki testasin nmap -sn komentoa. Komento ei antanut tuloksesi mit√§√§n, joten koitin muutaman kerran uudestaan ilman tulosta. Lopulta tarkistin metasploitablesta sen ip:n ja curlasin osoitteen kalilla. T√§st√§ sain varmuuden siit√§, ett√§ koneet pystyv√§t puhumaan toisillensa verkon sis√§ll√§. 

<img width="1286" height="849" alt="image" src="https://github.com/user-attachments/assets/9b001adb-2cb5-4261-87ae-0aeab5ea25a6" />
  
### Metasploitablen porttiskannaus
Seuraavaksi skannasin Metasploitablen portit. Kuitenkin sit√§ ennen pingasin varmuuden vuoksi 8.8.8.8 varmistuen siit√§, ett√§ en varmasti ole yhdistetty internettiin.

        ping 8.8.8.8

Sama nmap komento kuin viimeksi, paitsi nyt viel√§ -p- parametrilla. 

        nmap -A -T4 -p- 192.168.56.102

Tulokseksi tuli t√§llainen rimpsu:

    nmap  -A -T4 -p- 192.168.56.102
    Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-25 00:55 CEST
    mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
    Nmap scan report for 192.168.56.102
    Host is up (0.0024s latency).
    Not shown: 65505 closed tcp ports (reset)
    PORT      STATE SERVICE     VERSION
    21/tcp    open  ftp         vsftpd 2.3.4
    | ftp-syst: 
    |   STAT: 
    | FTP server status:
    |      Connected to 192.168.56.101
    |      Logged in as ftp
    |      TYPE: ASCII
    |      No session bandwidth limit
    |      Session timeout in seconds is 300
    |      Control connection is plain text
    |      Data connections will be plain text
    |      vsFTPd 2.3.4 - secure, fast, stable
    |_End of status
    |_ftp-anon: Anonymous FTP login allowed (FTP code 230)
    22/tcp    open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
    | ssh-hostkey: 
    |   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
    |_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
    23/tcp    open  telnet      Linux telnetd
    25/tcp    open  smtp        Postfix smtpd
    | sslv2: 
    |   SSLv2 supported
    |   ciphers: 
    |     SSL2_RC2_128_CBC_WITH_MD5
    |     SSL2_RC4_128_EXPORT40_WITH_MD5
    |     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
    |     SSL2_DES_192_EDE3_CBC_WITH_MD5
    |     SSL2_RC4_128_WITH_MD5
    |_    SSL2_DES_64_CBC_WITH_MD5
    | ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
    | Not valid before: 2010-03-17T14:07:45
    |_Not valid after:  2010-04-16T14:07:45
    |_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
    |_ssl-date: 2025-08-24T22:58:07+00:00; -1s from scanner time.
    53/tcp    open  domain      ISC BIND 9.4.2
    | dns-nsid: 
    |_  bind.version: 9.4.2
    80/tcp    open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
    |_http-title: Metasploitable2 - Linux
    |_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
    111/tcp   open  rpcbind     2 (RPC #100000)
    | rpcinfo: 
    |   program version    port/proto  service
    |   100000  2            111/tcp   rpcbind
    |   100000  2            111/udp   rpcbind
    |   100003  2,3,4       2049/tcp   nfs
    |   100003  2,3,4       2049/udp   nfs
    |   100005  1,2,3      33215/tcp   mountd
    |   100005  1,2,3      41407/udp   mountd
    |   100021  1,3,4      33179/udp   nlockmgr
    |   100021  1,3,4      34282/tcp   nlockmgr
    |   100024  1          55031/tcp   status
    |_  100024  1          55069/udp   status
    139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
    445/tcp   open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
    512/tcp   open  exec        netkit-rsh rexecd
    513/tcp   open  login
    514/tcp   open  shell       Netkit rshd
    1099/tcp  open  java-rmi    GNU Classpath grmiregistry
    1524/tcp  open  bindshell   Metasploitable root shell
    2049/tcp  open  nfs         2-4 (RPC #100003)
    2121/tcp  open  ftp         ProFTPD 1.3.1
    3306/tcp  open  mysql       MySQL 5.0.51a-3ubuntu5
    | mysql-info: 
    |   Protocol: 10
    |   Version: 5.0.51a-3ubuntu5
    |   Thread ID: 9
    |   Capabilities flags: 43564
    |   Some Capabilities: Speaks41ProtocolNew, Support41Auth, SupportsCompression, LongColumnFlag, SupportsTransactions, SwitchToSSLAfterHandshake, ConnectWithDatabase
    |   Status: Autocommit
    |_  Salt: )lf:.t$NA:@p5S&^,\n4
    3632/tcp  open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))
    5432/tcp  open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
    |_ssl-date: 2025-08-24T22:58:07+00:00; -1s from scanner time.
    | ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
    | Not valid before: 2010-03-17T14:07:45
    |_Not valid after:  2010-04-16T14:07:45
    5900/tcp  open  vnc         VNC (protocol 3.3)
    | vnc-info: 
    |   Protocol version: 3.3
    |   Security types: 
    |_    VNC Authentication (2)
    6000/tcp  open  X11         (access denied)
    6667/tcp  open  irc         UnrealIRCd
    6697/tcp  open  irc         UnrealIRCd
    8009/tcp  open  ajp13       Apache Jserv (Protocol v1.3)
    |_ajp-methods: Failed to get a valid response for the OPTION request
    8180/tcp  open  http        Apache Tomcat/Coyote JSP engine 1.1
    |_http-title: Apache Tomcat/5.5
    |_http-server-header: Apache-Coyote/1.1
    |_http-favicon: Apache Tomcat
    8787/tcp  open  drb         Ruby DRb RMI (Ruby 1.8; path /usr/lib/ruby/1.8/drb)
    33215/tcp open  mountd      1-3 (RPC #100005)
    34282/tcp open  nlockmgr    1-4 (RPC #100021)
    48560/tcp open  java-rmi    GNU Classpath grmiregistry
    55031/tcp open  status      1 (RPC #100024)
    MAC Address: 08:00:27:6E:86:67 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)
    Device type: general purpose
    Running: Linux 2.6.X
    OS CPE: cpe:/o:linux:linux_kernel:2.6
    OS details: Linux 2.6.9 - 2.6.33
    Network Distance: 1 hop
    Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
    
    Host script results:
    |_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
    | smb-os-discovery: 
    |   OS: Unix (Samba 3.0.20-Debian)
    |   Computer name: metasploitable
    |   NetBIOS computer name: 
    |   Domain name: localdomain
    |   FQDN: metasploitable.localdomain
    |_  System time: 2025-08-24T18:57:57-04:00
    |_smb2-time: Protocol negotiation failed (SMB2)
    | smb-security-mode: 
    |   account_used: <blank>
    |   authentication_level: user
    |   challenge_response: supported
    |_  message_signing: disabled (dangerous, but default)
    |_clock-skew: mean: 59m58s, deviation: 2h00m00s, median: -1s
    
    TRACEROUTE
    HOP RTT     ADDRESS
    1   2.42 ms 192.168.56.102
    
    OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
    Nmap done: 1 IP address (1 host up) scanned in 168.30 seconds


